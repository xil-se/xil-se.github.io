<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta name=author content="xil.se"><link rel=prev href=https://blog.xil.se/posts/pwn2win-2016-secret-accounts-rspkt/><link rel=next href=https://blog.xil.se/posts/is-eval-safe-yet-rspkt/><link rel=canonical href=https://blog.xil.se/posts/projects/rgbpad/rgbpad-1/><link rel=apple-touch-icon sizes=180x180 href=https://blog.xil.se/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://blog.xil.se/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://blog.xil.se/favicon-16x16.png><link rel=manifest href=https://blog.xil.se/site.webmanifest><link rel=mask-icon href=https://blog.xil.se/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><title>RGBPad project | Blog</title><meta name=title content="RGBPad project | Blog"><link rel=stylesheet href=https://blog.xil.se/font/iconfont.css><link rel=stylesheet href=https://blog.xil.se/css/main.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.xil.se\/"},"articleSection":"posts","name":"RGBPad project","headline":"RGBPad project","description":"Xil.se is more than just a CTF team. We\u0026rsquo;re doing some hardware projects and will start posting about them now. First out is the RGB Pad. A quite quick and dirty project, but fun nonetheless.\n\nRGBPad is a button pad with fully addressable RGB LEDs. It is acting as an I2C slave and is designed to be connected in an array of multiple devices.\nArchitecture  Each RGBPad has an STM32F030C8T6 on board that acts as an I2C slave with a unique ID.","inLanguage":"en-us","author":"kbeckmann","creator":"kbeckmann","publisher":"kbeckmann","accountablePerson":"kbeckmann","copyrightHolder":"kbeckmann","copyrightYear":"2016","datePublished":"2016-11-23 10:00:00 \u002b0100 \u002b0100","dateModified":"2016-11-23 10:00:00 \u002b0100 \u002b0100","url":"https:\/\/blog.xil.se\/posts\/projects\/rgbpad\/rgbpad-1\/","wordCount":"435","keywords":["Blog"]}</script></head><body><div class=wrapper><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=https://blog.xil.se/>Blog</a></div><div class="menu navbar-right"><a class=menu-item href=https://blog.xil.se/posts/>Blog</a>
<a class=menu-item href=https://blog.xil.se/categories/>Categories</a></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><div class=container><div class=navbar-header><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=https://blog.xil.se/>Blog</a></div><div class=menu-toggle><span></span><span></span><span></span></div></div><div class=menu id=mobile-menu><a class=menu-item href=https://blog.xil.se/posts/>Blog</a>
<a class=menu-item href=https://blog.xil.se/categories/>Categories</a></div></div></nav><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline">RGBPad project</h1><div class=post-meta>Written by <a itemprop=name href=https://blog.xil.se/author/kbeckmann rel=author>kbeckmann</a> with ♥
<span class=post-time>on <time datetime=2016-11-23 itemprop=datePublished>November 23, 2016</time></span>
in
<i class="iconfont icon-folder"></i><span class=post-category><a href=https://blog.xil.se/categories/projects/>projects</a></span></div></header><div class=post-content><p>Xil.se is more than just a CTF team. We&rsquo;re doing some hardware projects and will start posting about them now. First out is the RGB Pad. A quite quick and dirty project, but fun nonetheless.</p><p><a href=https://blog.xil.se/images/projects/rgbpad/board.gif><img src=https://blog.xil.se/images/projects/rgbpad/board.gif alt="Sorry about the vertical video"></a></p><p>RGBPad is a button pad with fully addressable RGB LEDs. It is acting as an I2C slave and is designed to be connected in an array of multiple devices.</p><h3 id=architecture>Architecture</h3><ul><li>Each RGBPad has an STM32F030C8T6 on board that acts as an I2C slave with a unique ID. This STM is dirt cheap and can be run without a crystal or passive components.</li><li>The RGBPads are connected to each other on a I2C bus.</li><li>When a button is pressed, the shared line NINT will be pulled down and the I2C master gets interrupted. This is to prevent the master from having to poll for button presses constantly. It may be a premature optimization though and will probably not be used.</li><li>Each RGBPad has its own framebuffer for the LEDs. By sending a specific command, the framebuffer may be updated and pushed out to the LEDs.</li><li>The LEDs used are the APA102. They have their own PWM and keep their state.</li></ul><p><a href=https://blog.xil.se/images/projects/rgbpad/board1.png><img src=https://blog.xil.se/images/projects/rgbpad/board1.png alt="alt tag"></a></p><h3 id=why>Why</h3><p>Because it&rsquo;s fun.</p><p>One idea is to use another device as a MIDI interface that uses these boards as keys/pads. Should be possible to use the not yet announced Thumbinator to do this.</p><h3 id=who>Who</h3><p>kbeckmann, arturo182</p><h3 id=wheres-the-code>Where&rsquo;s the code</h3><ul><li><a href=http://git.xil.se/kbeckmann/rgbpad-hw>Schematic and PCB design</a></li><li><a href=http://git.xil.se/kbeckmann/rgbpad-fw>Firmware for the RGBPad</a></li><li><a href=https://blog.xil.se/imgs/projects/rgbpad/rgbpad.pdf>Schematics in PDF</a></li></ul><h3 id=todo>TODO</h3><ul><li><input disabled type=checkbox> Write all the code</li><li><input disabled type=checkbox> Implement I2C slave<ul><li><input checked disabled type=checkbox> 0x01: Request button states. Reply with a uint16 with all the button states in row major order.</li><li><input checked disabled type=checkbox> 0x02: Set LED colors. Payload is a full framebuffer in snake order.</li><li><input disabled type=checkbox> 0x03: Fade to framebuffer. Sets a new framebuffer and blend colors to this using s-curve interpolation/ease inout. Should take a uint16 with length of animation in milliseconds.</li><li><input disabled type=checkbox> Use higher speed. 400 kHz should work, but we should try to go even faster.</li><li><input disabled type=checkbox> Make it more reliable. Recover after faliures after connecting more boards while running.</li></ul></li><li><input disabled type=checkbox> Implement I2C master on a STM32 for test that sends LED data and prints pressed buttons on UART.<ul><li>Partly done, implemented a quick hack in lua for the NodeMCU.</li></ul></li><li><input disabled type=checkbox> Implement some simple game (why not?).</li><li><input disabled type=checkbox> Finish the MIDI controller. But that&rsquo;s probably a project of its own.</li></ul><h3 id=project-log>Project log</h3><h4 id=2016-08-07>2016-08-07</h4><ul><li>PCB rev1 design is done.</li><li>10 PCBs have been ordered.</li><li>5 boards have been populated with components.</li><li>Firmware for I2C slave is in a demoable state in 100kHz mode.</li><li>Tested the firmware using a quick lua hack on a NodeMCU (ESP8266).</li><li>Got a 3d printed bezel from arturo182.</li></ul><p><img src=https://blog.xil.se/images/projects/rgbpad/board.jpg alt="alt tag"></p></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>xil.se</span></p><p class=copyright-item><span>Link:</span>
<a href=https://blog.xil.se/posts/projects/rgbpad/rgbpad-1/>https://blog.xil.se/posts/projects/rgbpad/rgbpad-1/</span></p></div><div class=post-tags><section><a href=javascript:window.history.back();>back</a></span> ·
<span><a href=https://blog.xil.se/>home</a></span></section></div><div class=post-nav><a href=https://blog.xil.se/posts/pwn2win-2016-secret-accounts-rspkt/ class=prev rel=prev title="Pwn2Win CTF 2016 Secret Accounts (Py 80) Writeup"><i class="iconfont icon-left"></i>&nbsp;Pwn2Win CTF 2016 Secret Accounts (Py 80) Writeup</a>
<a href=https://blog.xil.se/posts/is-eval-safe-yet-rspkt/ class=next rel=next title="Is eval safe yet? Arbitrary code execution in Python">Is eval safe yet? Arbitrary code execution in Python&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span class=with-love><i class="iconfont icon-love"></i></span><span class=author itemprop=copyrightHolder><a href=https://blog.xil.se/>xil.se</a> |</span>
<span>Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow">Hugo</a> & <a href=https://github.com/liuzc/leaveit target=_blank rel="external nofollow">LeaveIt</a></span></div></footer><link href=//lib.baomitu.com/lightgallery/1.6.11/css/lightgallery.min.css rel=stylesheet><script src=https://blog.xil.se/js/vendor_gallery.min.js async></script></div></body></html>