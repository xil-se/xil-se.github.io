<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta name=author content="xil.se"><link rel=prev href=https://blog.xil.se/posts/internetwache-2016-rev-50-arturo182/><link rel=next href=https://blog.xil.se/posts/internetwache-2016-exp-90-arturo182/><link rel=canonical href=https://blog.xil.se/posts/internetwache-2016-crypto-50-arturo182/><link rel=apple-touch-icon sizes=180x180 href=https://blog.xil.se/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://blog.xil.se/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://blog.xil.se/favicon-16x16.png><link rel=manifest href=https://blog.xil.se/site.webmanifest><link rel=mask-icon href=https://blog.xil.se/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><title>Internetwache CTF 2016 Crypto-Pirat (Crypto 50) Writeup | Blog</title><meta name=title content="Internetwache CTF 2016 Crypto-Pirat (Crypto 50) Writeup | Blog"><link rel=stylesheet href=https://blog.xil.se/font/iconfont.css><link rel=stylesheet href=https://blog.xil.se/css/main.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.xil.se\/"},"articleSection":"posts","name":"Internetwache CTF 2016 Crypto-Pirat (Crypto 50) Writeup","headline":"Internetwache CTF 2016 Crypto-Pirat (Crypto 50) Writeup","description":"Problem  Did the East German Secret Police see a Pirat on the sky? Help me find out!\n Attachment: https:\/\/ctf.internetwache.org\/files\/crypto50.zip\nSolution Sidenote: This one took us some time, we started ok but then our progress grinded to a halt because we just didn\u0026rsquo;t know what to do with the output we got. The organizers of the CTF agreed that the challenge was not clear enough and after 12 hours added two hints:","inLanguage":"en-us","author":"arturo182","creator":"arturo182","publisher":"arturo182","accountablePerson":"arturo182","copyrightHolder":"arturo182","copyrightYear":"2016","datePublished":"2016-02-21 14:20:00 \u002b0100 \u002b0100","dateModified":"2016-02-21 14:20:00 \u002b0100 \u002b0100","url":"https:\/\/blog.xil.se\/posts\/internetwache-2016-crypto-50-arturo182\/","wordCount":"731","keywords":["Blog"]}</script></head><body><div class=wrapper><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=https://blog.xil.se/>Blog</a></div><div class="menu navbar-right"><a class=menu-item href=https://blog.xil.se/posts/>Blog</a>
<a class=menu-item href=https://blog.xil.se/categories/>Categories</a></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><div class=container><div class=navbar-header><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=https://blog.xil.se/>Blog</a></div><div class=menu-toggle><span></span><span></span><span></span></div></div><div class=menu id=mobile-menu><a class=menu-item href=https://blog.xil.se/posts/>Blog</a>
<a class=menu-item href=https://blog.xil.se/categories/>Categories</a></div></div></nav><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline">Internetwache CTF 2016 Crypto-Pirat (Crypto 50) Writeup</h1><div class=post-meta>Written by <a itemprop=name href=https://blog.xil.se/author/arturo182 rel=author>arturo182</a> with ♥
<span class=post-time>on <time datetime=2016-02-21 itemprop=datePublished>February 21, 2016</time></span>
in
<i class="iconfont icon-folder"></i><span class=post-category><a href=https://blog.xil.se/categories/writeups/>writeups</a></span></div></header><div class=post-content><h1 id=problem>Problem</h1><blockquote><p>Did the East German Secret Police see a Pirat on the sky? Help me find out!</p></blockquote><p>Attachment: <a href=https://ctf.internetwache.org/files/crypto50.zip>https://ctf.internetwache.org/files/crypto50.zip</a></p><h1 id=solution>Solution</h1><p>Sidenote: This one took us some time, we started ok but then our progress grinded to a halt because we just didn&rsquo;t know what to do with the output we got. The organizers of the CTF agreed that the challenge was not clear enough and after 12 hours added two hints:</p><blockquote><p>Hint: We had 9 planets from 1930–2006&mldr;
Hint2: Each planet has a number. (There&rsquo;s a table on a well-known website). After that you might be interested in ciphers used by the secret police.</p></blockquote><p>Before the hints we figured out the first part (planets to numbers) but we had no idea what to do with the numbers. The secret police hint was very helpful.</p><p>On to the challenge!</p><p>We unzip and get a text file with pretty Unicode characters:</p><pre><code class=language-none data-lang=none>♆♀♇♀♆ ♇♇♀♆⊕ ♇♀♇♀♆ ♇♆♇♆⊕ ♆♇♆♇♇ ♀♆♇♆⊕ ♆♇♆♇♆ ♇♆♇♆⊕ ♆♇♇♀♇ ♀♆⊕♇♀ ♆⊕♇♀♆ ⊕♆♇♆♇ ♇♀♆♇♆ ⊕♇♀♇♀ ♆⊕♆♇♆ ♇♆♇♇♀ ♆⊕♆♇♆ ♇♆♇♆⊕ ♆♇♆♇♆ ♇♆⊕♇♀ ♆♇♇♀♆ ♇♆⊕♇♀ ♆♇♆♇♇ ♀♆⊕♆♇ ♆♇♇♀♇ ♀♇♀♆⊕ ♆♇♆♇♇ ♀♆⊕♇♀ ♇♀♆♇♆ ⊕♆♇♇♀ ♆⊕♇♀♆ ♇♇♀♇♀ ♆⊕♆♇♆ ♇♆♇♆♇ ♆⊕♇♀♆ ♇♇♀♆♇ ♆⊕♇♀♆ ♇♆♇♇♀ ♆⊕♆♇♆ ♇♇♀♇♀ ♇♀♆⊕♇ ♀♆♇♆♇ ♆⊕♇♀♇ ♀♇♀♆⊕ ♇♀♇♀♆ ♇♆♇♆⊕ ♆♇♆♇♆ ♇♆⊕♆♇ ♇♀♇♀♆ ⊕♆♇♆♇ ♆♇♆♇♇ ♀♆⊕♇♀ ♇♀♆♇♆ ♇♆⊕♆♇ ♆♇♆♇♇ ♀♇♀♆⊕ ♆♇♆♇♆ ♇♆⊕♆♇ ♇♀♆♇♆ ♇♆⊕♆♇ ♆♇♆♇♆ ♇♆♇♆⊕ ♆♇♇♀♇ ♀♆⊕♇♀ ♇♀♆♇♆ ⊕♆♇♆⊕ ♆♇♆♇♇ ♀♇♀♇♀ ♆⊕♇♀♆ ♇♇♀♆♇ ♆⊕♇♀♇ ♀♆♇♆♇ ♆♇♆⊕♇ ♀♆♇♆⊕ ♇♀♇♀♆ ♇♆♇♆⊕ ♆♇♆♇♆ ♇♆⊕♇♀ ♆♇♆♇♇ ♀♆⊕♆♇ ♆⊕♇♀♇ ♀♇♀♆⊕ ♆♇♇♀♆ ♇♆⊕♆♇ ♇♀♇♀♇ ♀♆⊕♆♇ ♇♀♇♀♆ ♇♆⊕♆♇ ♆♇♇♀♆ ⊕♇♀♆♇ ♆♇♆♇♇ ♀♆⊕♇♀ ♆♇♆♇♆ ♇♇♀♆⊕ ♇♀♆♇♆ ♇♆♇♇♀ ♆⊕♇♀♆ ♇♆♇♆♇ ♇♀♆⊕♇ ♀♆♇♆♇ ♆♇♇♀♆ ⊕♇♀♆♇ ♆♇♆♇♇ ♀
</code></pre><p>There are 4 unique characters in the file, they are all symbols of planets in our solar system:</p><p>| Symbol | Planet | Number of planet |
|&mdash;&mdash;|&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;|
| ♀ | Venus | 2 |
| ⊕ | Earth | 3 |
| ♆ | Neptune | 8 |
| ♇ | Pluto | 9 |</p><p>We replace the characters with their numbers and get:</p><pre><code class=language-none data-lang=none>82928 99283 92928 98983 89899 28983 89898 98983 89929 28392 83928 38989 92898 39292 83898 98992 83898 98983 89898 98392 89928 98392 89899 28389 89929 29283 89899 28392 92898 38992 83928 99292 83898 98989 83928 99289 83928 98992 83898 99292 92839 28989 83929 29283 92928 98983 89898 98389 92928 38989 89899 28392 92898 98389 89899 29283 89898 98389 92898 98389 89898 98983 89929 28392 92898 38983 89899 29292 83928 99289 83929 28989 89839 28983 92928 98983 89898 98392 89899 28389 83929 29283 89928 98389 92929 28389 92928 98389 89928 39289 89899 28392 89898 99283 92898 98992 83928 98989 92839 28989 89928 39289 89899 2
</code></pre><p>This is where we got stuck, there were just too many things that could be done with this data and too many ways it could have been interpreted.</p><p>After the hint, we managed to find a <a href=https://rgpsecurity.wordpress.com/2014/10/17/stasi-vernam-cipher-gernator-tapir/>code</a> used by the <a href=https://en.wikipedia.org/wiki/Stasi>Stasi</a> (East German Secret Police). It was named TAPIR (anagram of PIRAT, from the challenge&rsquo;s name) and it used numbers grouped in quintuples, it was perfect.</p><p>The code uses a special table to convert 1- and 2-digit sequences into characters.
<img src=https://blog.xil.se/imgs/internetwache-2016-crypto-50-arturo182_tapir.jpg alt=TAPIR></p><p>When we merged all the 5-digit groups into one string and divided them into 2-digit groups, we found out that there are only 4 unique groups:</p><table><thead><tr><th>Number</th><th>Meaning</th></tr></thead><tbody><tr><td>82</td><td>Zi - Switch to numbers (green in the above table)</td></tr><tr><td>83</td><td>ZwR - space</td></tr><tr><td>89</td><td>. (period)</td></tr><tr><td>92</td><td>- (dash)</td></tr></tbody></table><p>With that knowledge, we could use python to decipher the numbers:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># coding=utf8</span>

f <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;README.txt&#39;</span>)
line <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>readline()<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>)
s <span style=color:#f92672>=</span> line<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39; &#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>)

<span style=color:#75715e># Unicode, in my code? How unorthodox!</span>
s <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;♀&#39;</span>, <span style=color:#e6db74>&#39;2&#39;</span>)
s <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;⊕&#39;</span>, <span style=color:#e6db74>&#39;3&#39;</span>)
s <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;♆&#39;</span>, <span style=color:#e6db74>&#39;8&#39;</span>)
s <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;♇&#39;</span>, <span style=color:#e6db74>&#39;9&#39;</span>)

words <span style=color:#f92672>=</span> []
this <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span> <span style=color:#75715e># C++/C#/Java/JavaScript programmers shed a single tear</span>
<span style=color:#66d9ef>for</span> n <span style=color:#f92672>in</span> [s[i:i<span style=color:#f92672>+</span><span style=color:#ae81ff>2</span>] <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>, len(s), <span style=color:#ae81ff>2</span>)]:
    <span style=color:#66d9ef>if</span> n <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;82&#39;</span>:
        <span style=color:#66d9ef>continue</span>
    <span style=color:#66d9ef>elif</span> n <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;92&#39;</span>:
        this <span style=color:#f92672>=</span> this <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;-&#39;</span>
    <span style=color:#66d9ef>elif</span> n <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;89&#39;</span>:
        this <span style=color:#f92672>=</span> this <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;.&#39;</span>
    <span style=color:#66d9ef>elif</span> n <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;83&#39;</span>:
        words<span style=color:#f92672>.</span>append(this)
        this <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>

<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#39; &#39;</span><span style=color:#f92672>.</span>join(words)
</code></pre></div><p>The output:</p><pre><code class=language-none data-lang=none>-.- --.. ..-. .... .-- - - ..-. -- ...- ... ... -.-. -..- ..--- ..- --. .- -.-- .... -.-. -..- ..--- -.. --- --.. ... .-- ....- --.. ...-- ... .-.. ..... .-- --. . ..--- -.-. --... -. --.. ... -..- . --- .-. .--- .--. ..- -...- -...- -...- -...- -...-
</code></pre><p>Which is morse code for:</p><pre><code class=language-none data-lang=none>KZFHWTTFMVSSCX2UGAYHCX2DOZSW4Z3SL5WGE2C7NZSXEORJPU====
</code></pre><p>Which is base32 for:</p><pre><code class=language-none data-lang=none>VJ{Neee!_T00q_Cvengr_lbh_ner:)}
</code></pre><p>Which is rot-13 for:</p><pre><code class=language-none data-lang=none>IW{Arrr!_G00d_Pirate_you_are:)}
</code></pre><p>Flag: IW{Arrr!_G00d_Pirate_you_are:)}</p></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>xil.se</span></p><p class=copyright-item><span>Link:</span>
<a href=https://blog.xil.se/posts/internetwache-2016-crypto-50-arturo182/>https://blog.xil.se/posts/internetwache-2016-crypto-50-arturo182/</span></p></div><div class=post-tags><section><a href=javascript:window.history.back();>back</a></span> ·
<span><a href=https://blog.xil.se/>home</a></span></section></div><div class=post-nav><a href=https://blog.xil.se/posts/internetwache-2016-rev-50-arturo182/ class=prev rel=prev title="Internetwache CTF 2016 SPIM (Rev 50) Writeup"><i class="iconfont icon-left"></i>&nbsp;Internetwache CTF 2016 SPIM (Rev 50) Writeup</a>
<a href=https://blog.xil.se/posts/internetwache-2016-exp-90-arturo182/ class=next rel=next title="Internetwache CTF 2016 Sh-ock (Exp 90) Writeup">Internetwache CTF 2016 Sh-ock (Exp 90) Writeup&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span class=with-love><i class="iconfont icon-love"></i></span><span class=author itemprop=copyrightHolder><a href=https://blog.xil.se/>xil.se</a> |</span>
<span>Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow">Hugo</a> & <a href=https://github.com/liuzc/leaveit target=_blank rel="external nofollow">LeaveIt</a></span></div></footer><link href=//lib.baomitu.com/lightgallery/1.6.11/css/lightgallery.min.css rel=stylesheet><script src=https://blog.xil.se/js/vendor_gallery.min.js async></script></div></body></html>