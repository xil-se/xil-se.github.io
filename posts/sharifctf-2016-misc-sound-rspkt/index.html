<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta name=author content="xil.se"><link rel=prev href=https://blog.xil.se/posts/sharifctf-2016-misc-secure2/><link rel=next href=https://blog.xil.se/posts/internetwache-2016-crypto60-kbeckmann/><link rel=canonical href=https://blog.xil.se/posts/sharifctf-2016-misc-sound-rspkt/><link rel=apple-touch-icon sizes=180x180 href=https://blog.xil.se/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://blog.xil.se/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://blog.xil.se/favicon-16x16.png><link rel=manifest href=https://blog.xil.se/site.webmanifest><link rel=mask-icon href=https://blog.xil.se/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><title>SharifCTF 2016 Hack By The Sound (Misc 200) Writeup | Blog</title><meta name=title content="SharifCTF 2016 Hack By The Sound (Misc 200) Writeup | Blog"><link rel=stylesheet href=https://blog.xil.se/font/iconfont.css><link rel=stylesheet href=https://blog.xil.se/css/main.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.xil.se\/"},"articleSection":"posts","name":"SharifCTF 2016 Hack By The Sound (Misc 200) Writeup","headline":"SharifCTF 2016 Hack By The Sound (Misc 200) Writeup","description":"Problem  A well known blogger has came to a hotel that we had good relationships with its staffs.\nWe tried to capture the sound of his room by placing a microphone inside the desk.\nWe have recorded the sound about the time that he has typed a text in his blogg. You could find the text he typed in \u0026ldquo;Blog Text.txt\u0026rdquo;.\nWe reduce noises somehow and found that many characters may have the same keysound.","inLanguage":"en-us","author":"rspkt","creator":"rspkt","publisher":"rspkt","accountablePerson":"rspkt","copyrightHolder":"rspkt","copyrightYear":"2016","datePublished":"2016-02-07 14:00:00 \u002b0100 \u002b0100","dateModified":"2016-02-07 14:00:00 \u002b0100 \u002b0100","url":"https:\/\/blog.xil.se\/posts\/sharifctf-2016-misc-sound-rspkt\/","wordCount":"551","keywords":["Blog"]}</script></head><body><div class=wrapper><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=https://blog.xil.se/>Blog</a></div><div class="menu navbar-right"><a class=menu-item href=https://blog.xil.se/posts/>Blog</a>
<a class=menu-item href=https://blog.xil.se/categories/>Categories</a></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><div class=container><div class=navbar-header><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=https://blog.xil.se/>Blog</a></div><div class=menu-toggle><span></span><span></span><span></span></div></div><div class=menu id=mobile-menu><a class=menu-item href=https://blog.xil.se/posts/>Blog</a>
<a class=menu-item href=https://blog.xil.se/categories/>Categories</a></div></div></nav><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline">SharifCTF 2016 Hack By The Sound (Misc 200) Writeup</h1><div class=post-meta>Written by <a itemprop=name href=https://blog.xil.se/author/rspkt rel=author>rspkt</a> with ♥
<span class=post-time>on <time datetime=2016-02-07 itemprop=datePublished>February 7, 2016</time></span>
in
<i class="iconfont icon-folder"></i><span class=post-category><a href=https://blog.xil.se/categories/writeups/>writeups</a></span></div></header><div class=post-content><h1 id=problem>Problem</h1><blockquote><p>A well known blogger has came to a hotel that we had good relationships with its staffs.</p><p>We tried to capture the sound of his room by placing a microphone inside the desk.</p><p>We have recorded the sound about the time that he has typed a text in his blogg. You could
find the text he typed in &ldquo;Blog Text.txt&rdquo;.</p><p>We reduce noises somehow and found that many characters may have the same keysound. Also
we know that he use meaningful username and password.</p><p>Could you extract the username and password of his blog?</p><p>flag is concatenation of his username and password as usernamepassword.</p></blockquote><p>Points: 200</p><p>Solved by 16 team(s)</p><h1 id=solution>Solution</h1><p>For this challenge we were provided a txt-file containing the blog post, as
well as a wav-file containing the barely audible &ldquo;recording&rdquo; of the blogger
typing his post.</p><p>As a first step, I normalized the wav file in <a href=http://www.audacityteam.org>Audacity</a>.
This makes the file a bit easier to work with.</p><p>I suspected that this challenge would require lots of manual labour, such as
annotation, so after some browsing I came across <a href=http://www.fon.hum.uva.nl/praat/>Praat</a>,
a phonetics toolkit capable of annotating and analyzing waveforms.</p><p>It was fairly easy to map the words in the text file we were given to the
waveform. The waveform begins with the blogger entering three strings of text,
and then starts writing the post. We can assume that these three inputs are
URL, username and password.</p><p><a href=https://blog.xil.se/imgs/sharifctf-2016-misc-sound-rspkt_praat.png><img src=https://blog.xil.se/imgs/sharifctf-2016-misc-sound-rspkt_praat.png alt="Praat in action"></a></p><p>Looking closer at the waveform, it seems like there&rsquo;s differences in the
peak amplitudes for different characters. I went ahead and wrote down the
peak intensities for different input characters, and wound up with the table
below:</p><table><thead><tr><th>Char</th><th>Recorded intensities</th></tr></thead><tbody><tr><td>a</td><td><code>60.98</code>, <code>60.77</code>, <code>60.85</code></td></tr><tr><td>b</td><td><code>66.16</code></td></tr><tr><td>c</td><td><code>63.94</code>, <code>63.88</code>, <code>63.94</code></td></tr><tr><td>d</td><td><code>63.90</code>, <code>63.99</code>, <code>63.88</code></td></tr><tr><td>e</td><td><code>64.03</code>, <code>63.96</code>, <code>63.97</code></td></tr><tr><td>f</td><td><code>65.16</code>, <code>65.09</code></td></tr><tr><td>g</td><td></td></tr><tr><td>h</td><td><code>67.15</code></td></tr><tr><td>i</td><td><code>68.30</code>, <code>68.23</code>, <code>68.17</code></td></tr><tr><td>j</td><td><code>67.74</code></td></tr><tr><td>k</td><td></td></tr><tr><td>l</td><td><code>68.23</code>, <code>68.22</code>, <code>68.30</code></td></tr><tr><td>m</td><td><code>67.69</code></td></tr><tr><td>n</td><td><code>67.05</code>, <code>67.02</code>, <code>67.10</code></td></tr><tr><td>o</td><td><code>68.73</code>, <code>68.78</code>, <code>68.76</code></td></tr><tr><td>p</td><td><code>68.67</code>, <code>68.81</code></td></tr><tr><td>q</td><td></td></tr><tr><td>r</td><td><code>65.21</code>, <code>65.12</code></td></tr><tr><td>s</td><td><code>62.49</code>, <code>62.56</code>, <code>62.57</code></td></tr><tr><td>t</td><td><code>66.21</code>, <code>66.17</code>, <code>66.16</code></td></tr><tr><td>u</td><td><code>67.70</code></td></tr><tr><td>v</td><td></td></tr><tr><td>w</td><td><code>62.40</code></td></tr><tr><td>x</td><td></td></tr><tr><td>y</td><td><code>67.12</code>, <code>67.17</code>, <code>67.17</code></td></tr><tr><td>z</td><td></td></tr></tbody></table><p>What&rsquo;s worth noting here is that the intensity seems to correlate with the
position of the character on the keyboard. Characters on the far left (<code>a</code>,
<code>s</code>, <code>w</code>) have lower intensities than those on the far right (<code>o</code>, <code>p</code>, <code>l</code>).
My theory is that this behavior simulates that the right side of the bloggers
laptop is closer to the microphone.</p><p>Another thing I noted is that characters on the same keyboard &ldquo;row&rdquo; have
indistinguishable intensities. The characters <code>e</code>, <code>d</code> and <code>c</code> are an example of
this. This means that we have to consider each row of characters when trying to
infer the bloggers credentials.</p><p>Going back to the credentials input, I came up with the following candidates:</p><p>Username:</p><table><thead><tr><th>Intensity</th><th>Candidates</th></tr></thead><tbody><tr><td>60.79</td><td><code>q</code>, <code>a</code>, <code>z</code></td></tr><tr><td>63.87</td><td><code>e</code>, <code>d</code>, <code>c</code></td></tr><tr><td>67.68</td><td><code>u</code>, <code>j</code>, <code>m</code></td></tr><tr><td>68.31</td><td><code>i</code>, <code>k</code></td></tr><tr><td>67.20</td><td><code>y</code>, <code>h</code>, <code>n</code></td></tr></tbody></table><p>Password:</p><table><thead><tr><th>Intensity</th><th>Candidates</th></tr></thead><tbody><tr><td>62.52</td><td><code>w</code>, <code>s</code>, <code>x</code></td></tr><tr><td>68.81</td><td><code>o</code>, <code>l</code></td></tr><tr><td>67.69</td><td><code>u</code>, <code>j</code>, <code>m</code></td></tr><tr><td>63.88</td><td><code>e</code>, <code>d</code>, <code>c</code></td></tr><tr><td>66.21</td><td><code>t</code>, <code>g</code>, <code>b</code></td></tr><tr><td>67.15</td><td><code>y</code>, <code>h</code>, <code>n</code></td></tr><tr><td>68.27</td><td><code>i</code>, <code>k</code></td></tr><tr><td>67.12</td><td><code>y</code>, <code>h</code>, <code>n</code></td></tr><tr><td>66.23</td><td><code>t</code>, <code>g</code>, <code>b</code></td></tr></tbody></table><p>After a few seconds of ocular analysis, it&rsquo;s clear that the username is <em>admin</em>
and the password is <em>something</em>.</p><p>This gives us our flag, <strong>adminsomething</strong>.</p></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>xil.se</span></p><p class=copyright-item><span>Link:</span>
<a href=https://blog.xil.se/posts/sharifctf-2016-misc-sound-rspkt/>https://blog.xil.se/posts/sharifctf-2016-misc-sound-rspkt/</span></p></div><div class=post-tags><section><a href=javascript:window.history.back();>back</a></span> ·
<span><a href=https://blog.xil.se/>home</a></span></section></div><div class=post-nav><a href=https://blog.xil.se/posts/sharifctf-2016-misc-secure2/ class=prev rel=prev title="SharifCTF 2016 Sec-Coding 2 (Misc 300) Writeup"><i class="iconfont icon-left"></i>&nbsp;SharifCTF 2016 Sec-Coding 2 (Misc 300) Writeup</a>
<a href=https://blog.xil.se/posts/internetwache-2016-crypto60-kbeckmann/ class=next rel=next title="InternetWache 2016 Oh Bob! (Crypto 60) Writeup">InternetWache 2016 Oh Bob! (Crypto 60) Writeup&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span class=with-love><i class="iconfont icon-love"></i></span><span class=author itemprop=copyrightHolder><a href=https://blog.xil.se/>xil.se</a> |</span>
<span>Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow">Hugo</a> & <a href=https://github.com/liuzc/leaveit target=_blank rel="external nofollow">LeaveIt</a></span></div></footer><link href=//lib.baomitu.com/lightgallery/1.6.11/css/lightgallery.min.css rel=stylesheet><script src=https://blog.xil.se/js/vendor_gallery.min.js async></script></div></body></html>