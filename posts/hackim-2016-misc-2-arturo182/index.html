<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta name=author content="xil.se"><link rel=prev href=https://blog.xil.se/posts/hackim-2016-programming-1-arturo182/><link rel=next href=https://blog.xil.se/posts/hackim-2016-crypto-3-arturo182/><link rel=canonical href=https://blog.xil.se/posts/hackim-2016-misc-2-arturo182/><link rel=apple-touch-icon sizes=180x180 href=https://blog.xil.se/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://blog.xil.se/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://blog.xil.se/favicon-16x16.png><link rel=manifest href=https://blog.xil.se/site.webmanifest><link rel=mask-icon href=https://blog.xil.se/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><title>HackIM 2016 Misc 2 Writeup | Blog</title><meta name=title content="HackIM 2016 Misc 2 Writeup | Blog"><link rel=stylesheet href=https://blog.xil.se/font/iconfont.css><link rel=stylesheet href=https://blog.xil.se/css/main.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.xil.se\/"},"articleSection":"posts","name":"HackIM 2016 Misc 2 Writeup","headline":"HackIM 2016 Misc 2 Writeup","description":"Hiding In Plain Sight - 200pts","inLanguage":"en-us","author":"xil.se","creator":"xil.se","publisher":"xil.se","accountablePerson":"xil.se","copyrightHolder":"xil.se","copyrightYear":"2016","datePublished":"2016-01-31 00:00:00 \u002b0000 UTC","dateModified":"2016-01-31 00:00:00 \u002b0000 UTC","url":"https:\/\/blog.xil.se\/posts\/hackim-2016-misc-2-arturo182\/","wordCount":"361","keywords":["ctf","hackim","Blog"]}</script></head><body><div class=wrapper><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=https://blog.xil.se/>Blog</a></div><div class="menu navbar-right"><a class=menu-item href=https://blog.xil.se/posts/>Blog</a>
<a class=menu-item href=https://blog.xil.se/categories/>Categories</a></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><div class=container><div class=navbar-header><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=https://blog.xil.se/>Blog</a></div><div class=menu-toggle><span></span><span></span><span></span></div></div><div class=menu id=mobile-menu><a class=menu-item href=https://blog.xil.se/posts/>Blog</a>
<a class=menu-item href=https://blog.xil.se/categories/>Categories</a></div></div></nav><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline">HackIM 2016 Misc 2 Writeup</h1><div class=post-meta>Written by <a itemprop=name href=https://blog.xil.se/author/%3Cnil%3E rel=author>xil.se</a> with ♥
<span class=post-time>on <time datetime=2016-01-31 itemprop=datePublished>January 31, 2016</time></span>
in
<i class="iconfont icon-folder"></i><span class=post-category><a href=https://blog.xil.se/categories/writeups/>writeups</a></span></div></header><div class=post-content><h1 id=problem>Problem</h1><blockquote><p>Find out the secret key hidden in these packets!</p></blockquote><p>Attachement: <a href=http://ctf.nullcon.net/misc/m200-HiPs.rar>http://ctf.nullcon.net/misc/m200-HiPs.rar</a></p><p>Files:</p><ul><li>f101.pcap</li><li>f102.pcap</li><li>f103.pcap</li></ul><h1 id=solution>Solution</h1><p>We get three <strong>p</strong>acket <strong>cap</strong>ture files, when inspecting with Wireshark, we can see they log ping requests and responses between two hosts. Upon closer inspection we see that they seem to have quite large data payloads attached, so we decided to extract and concatenate all the data from the first file.<br>It was not immediately clear what the data was, but upon further inspection and some research, I decided to try using yEnc:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> scapy.all <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
<span style=color:#f92672>from</span> yenc <span style=color:#f92672>import</span> decode

pcap <span style=color:#f92672>=</span> rdpcap(<span style=color:#e6db74>&#39;f101.pcap&#39;</span>)
f <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;f101.yenc&#39;</span>,<span style=color:#e6db74>&#39;w&#39;</span>)

<span style=color:#66d9ef>for</span> p <span style=color:#f92672>in</span> pcap:
    <span style=color:#66d9ef>if</span> p[ICMP]<span style=color:#f92672>.</span>type <span style=color:#f92672>==</span> <span style=color:#ae81ff>8</span>:
        f<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(str(p[Raw])))

f<span style=color:#f92672>.</span>close()

decode(<span style=color:#e6db74>&#39;f101.yenc&#39;</span>, <span style=color:#e6db74>&#39;f101.bin&#39;</span>)
</code></pre></div><p>This gave us a binary file with an interesting content inside:</p><pre><code>...snip...
00007a0: 0a3f 7b29 2b7b 7d5b 5d2b 3d3c 2b2f 285d 402b 5b5d 293f 265d 282e 3c7d 7b2a 255e  .?{)+{}[]+=&lt;+/(]@+[])?&amp;](.&lt;}{*%^
00007c0: 3f7e 283f 7b26 2d3d 2e2e 405d 2d28 3d2d 5e2d 292d 2b7d 2a7d 3c7e 5d5e 3c28 5b5b  ?~(?{&amp;-=..@]-(=-^-)-+}*}&lt;~]^&lt;([[
00007e0: 2d0a 293a 7b2d 407d 2a5d 7c2a 2f7b 5b5b 7b7e 5b2f 2c28 7d7d 2b2f 407c 7b3f 3e2f  -.):{-@}*]|*/{[[{~[/,(}}+/@|{?&gt;/
0000800: 3e25 267b 5b2b 3c2a 2c3d 285b 2d5e 407b 2c2f 283d 5d3c 2f3a 265e 2c3a 2629 3d2d  &gt;%&amp;{[+&lt;*,=([-^@{,/(=]&lt;/:&amp;^,:&amp;)=-
0000820: 2926 0a5a 574e 6f62 7941 695a 6949 4b5a 574e 6f62 7941 6962 4349 4b5a 574e 6f62  )&amp;.ZWNobyAiZiIKZWNobyAibCIKZWNob
0000840: 7941 6959 5349 4b5a 574e 6f62 7941 695a 7949 4b5a 574e 6f62 7941 6965 7949 4b5a  yAiYSIKZWNobyAiZyIKZWNobyAieyIKZ
0000860: 574e 6f0a 6279 4169 6257 5131 6333 5674 4967 706c 5932 6876 4943 496f 4a32 5a73  WNo.byAibWQ1c3VtIgplY2hvICIoJ2Zs
0000880: 5957 636e 4b53 494b 5a57 4e6f 6279 4169 6653 494b 3a7b 2b5d 3d5e 7e7e 2e40 2d5e  YWcnKSIKZWNobyAifSIK:{+]=^~~.@-^
00008a0: 3c2b 2e3e 0a3c 2f28 253e 2b28 292f 2a2e 7d28 3e25 3c2e 7b2a 253a 3e40 2c2d 7b2b  &lt;+.&gt;.&lt;/(%&gt;+()/*.}(&gt;%&lt;.{*%:&gt;@,-{+
00008c0: 2c5e 3f2c 2f40 2f7d 3a2b 293d 3d2e 257b 2d7e 253d 3e29 3a7d 2b5d 2a29 5d3d 7c40  ,^?,/@/}:+)==.%{-~%=&gt;):}+]*)]=|@
00008e0: 2a3a 263e 3c0a 3f7b 2c5d 2e2d 2e7d 5e29 7e26 3d7e 255d 7e3d 3c3d 3f2f 2f7b 4028  *:&amp;&gt;&lt;.?{,].-.}^)~&amp;=~%]~=&lt;=?//{@(
...snip...
</code></pre><p>If we remove the newline from the ASCII text we get: <code>ZWNobyAiZiIKZWNobyAibCIKZWNobyAiYSIKZWNobyAiZyIKZWNobyAieyIKZWNobyAibWQ1c3VtIgplY2hvICIoJ2ZsYWcnKSIKZWNobyAifSIK</code> which is base64 for:</p><pre><code>echo &quot;f&quot;
echo &quot;l&quot;
echo &quot;a&quot;
echo &quot;g&quot;
echo &quot;{&quot;
echo &quot;md5sum&quot;
echo &quot;('flag')&quot;
echo &quot;}&quot;
</code></pre><p>Flag: flag{327a6c4304ad5938eaf0efb6cc3e53dc}</p></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>xil.se</span></p><p class=copyright-item><span>Link:</span>
<a href=https://blog.xil.se/posts/hackim-2016-misc-2-arturo182/>https://blog.xil.se/posts/hackim-2016-misc-2-arturo182/</span></p></div><div class=post-tags><section><i class="iconfont icon-tag"></i>Tag(s):
<span class=tag><a href=https://blog.xil.se/tags/ctf/>#ctf</a></span>
<span class=tag><a href=https://blog.xil.se/tags/hackim/>#hackim</a></span></section><section><a href=javascript:window.history.back();>back</a></span> ·
<span><a href=https://blog.xil.se/>home</a></span></section></div><div class=post-nav><a href=https://blog.xil.se/posts/hackim-2016-programming-1-arturo182/ class=prev rel=prev title="HackIM 2016 Programming 1 Writeup"><i class="iconfont icon-left"></i>&nbsp;HackIM 2016 Programming 1 Writeup</a>
<a href=https://blog.xil.se/posts/hackim-2016-crypto-3-arturo182/ class=next rel=next title="HackIM 2016 Crypto 3 Writeup">HackIM 2016 Crypto 3 Writeup&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span class=with-love><i class="iconfont icon-love"></i></span><span class=author itemprop=copyrightHolder><a href=https://blog.xil.se/>xil.se</a> |</span>
<span>Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow">Hugo</a> & <a href=https://github.com/liuzc/leaveit target=_blank rel="external nofollow">LeaveIt</a></span></div></footer><script src=https://blog.xil.se/js/vendor_no_gallery.min.js async></script></div></body></html>