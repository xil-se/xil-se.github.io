<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta name=author content="xil.se"><link rel=prev href=https://blog.xil.se/posts/sharifctf-2016-forensics-uagent-arturo182/><link rel=next href=https://blog.xil.se/posts/sharifctf-2016-forensics-blocks-arturo182/><link rel=canonical href=https://blog.xil.se/posts/sharifctf-2016-forensics-fashion-flag-arturo182/><link rel=apple-touch-icon sizes=180x180 href=https://blog.xil.se/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://blog.xil.se/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://blog.xil.se/favicon-16x16.png><link rel=manifest href=https://blog.xil.se/site.webmanifest><link rel=mask-icon href=https://blog.xil.se/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><title>SharifCTF 2016 We lost the Fashion Flag! (Forensics 100) Writeup | Blog</title><meta name=title content="SharifCTF 2016 We lost the Fashion Flag! (Forensics 100) Writeup | Blog"><link rel=stylesheet href=https://blog.xil.se/font/iconfont.css><link rel=stylesheet href=https://blog.xil.se/css/main.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.xil.se\/"},"articleSection":"posts","name":"SharifCTF 2016 We lost the Fashion Flag! (Forensics 100) Writeup","headline":"SharifCTF 2016 We lost the Fashion Flag! (Forensics 100) Writeup","description":"Problem  In Sharif CTF we have lots of task ready to use, so we stored their data about author or creation date and other related information in some files. But one of our staff used a method to store data efficiently and left the group some days ago. So if you want the flag for this task, you have to find it yourself!\n Attachement: A tar.gz file\nSolution After unpacking the tarball we get two files: sharif_tasks.","inLanguage":"en-us","author":"arturo182","creator":"arturo182","publisher":"arturo182","accountablePerson":"arturo182","copyrightHolder":"arturo182","copyrightYear":"2016","datePublished":"2016-02-06 20:44:49 \u002b0100 \u002b0100","dateModified":"2016-02-06 20:44:49 \u002b0100 \u002b0100","url":"https:\/\/blog.xil.se\/posts\/sharifctf-2016-forensics-fashion-flag-arturo182\/","wordCount":"255","keywords":["Blog"]}</script></head><body><div class=wrapper><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=https://blog.xil.se/>Blog</a></div><div class="menu navbar-right"><a class=menu-item href=https://blog.xil.se/posts/>Blog</a>
<a class=menu-item href=https://blog.xil.se/categories/>Categories</a></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><div class=container><div class=navbar-header><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=https://blog.xil.se/>Blog</a></div><div class=menu-toggle><span></span><span></span><span></span></div></div><div class=menu id=mobile-menu><a class=menu-item href=https://blog.xil.se/posts/>Blog</a>
<a class=menu-item href=https://blog.xil.se/categories/>Categories</a></div></div></nav><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline">SharifCTF 2016 We lost the Fashion Flag! (Forensics 100) Writeup</h1><div class=post-meta>Written by <a itemprop=name href=https://blog.xil.se/author/arturo182 rel=author>arturo182</a> with ♥
<span class=post-time>on <time datetime=2016-02-06 itemprop=datePublished>February 6, 2016</time></span>
in
<i class="iconfont icon-folder"></i><span class=post-category><a href=https://blog.xil.se/categories/writeups/>writeups</a></span></div></header><div class=post-content><h1 id=problem>Problem</h1><blockquote><p>In Sharif CTF we have lots of task ready to use, so we stored their data about author or creation date and other related information in some files. But one of our staff used a method to store data efficiently and left the group some days ago. So if you want the flag for this task, you have to find it yourself!</p></blockquote><p>Attachement: A tar.gz file</p><h1 id=solution>Solution</h1><p>After unpacking the tarball we get two files: <code>sharif_tasks.tgz</code> and <code>fashion.model</code>, unpacking the tgz file gives us a directory of over 12000 data files. They are not very interesting, not just yet. The fashion.model file also seems to be a nondescript data, at least according to <code>file</code>. But if we look inside, we can see:</p><pre><code class=language-none data-lang=none>0000000: 0800 0000 4665 6d74 6f5a 6970 0000 0000  ....FemtoZip....
</code></pre><p>A quick Google search return <a href=https://github.com/gtoubassi/femtozip>the source</a> for a fzip utility, which we build and run like so:</p><pre><code class=language-none data-lang=none>fzip --model fashion.model --decompress out --verbose
</code></pre><p>That unpacked all the 12000+ files! If we check any of them, they all seem to be json definitions of CTF challenges with flags included. That means we have 120k+ flags to go through! Luckily, each challenge has information such as category, points, year, so we can just grep for our current challenge:</p><pre><code class=language-none data-lang=none>sed -e '$s/$/\n/' -s * | grep 2016 | grep foren | grep &quot;'points': 100&quot;
</code></pre><p>This returns 5 flags, which is way better thank 12000, we can try each of them. It just so happens that the first one is the correct one!</p><p>Flag: SharifCTF{2b9cb0a67a536ff9f455de0bd729cf57}</p></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>xil.se</span></p><p class=copyright-item><span>Link:</span>
<a href=https://blog.xil.se/posts/sharifctf-2016-forensics-fashion-flag-arturo182/>https://blog.xil.se/posts/sharifctf-2016-forensics-fashion-flag-arturo182/</span></p></div><div class=post-tags><section><a href=javascript:window.history.back();>back</a></span> ·
<span><a href=https://blog.xil.se/>home</a></span></section></div><div class=post-nav><a href=https://blog.xil.se/posts/sharifctf-2016-forensics-uagent-arturo182/ class=prev rel=prev title="SharifCTF 2016 Uagent (Forensics 100) Writeup"><i class="iconfont icon-left"></i>&nbsp;SharifCTF 2016 Uagent (Forensics 100) Writeup</a>
<a href=https://blog.xil.se/posts/sharifctf-2016-forensics-blocks-arturo182/ class=next rel=next title="SharifCTF 2016 Blocks (Forensics 400) Writeup">SharifCTF 2016 Blocks (Forensics 400) Writeup&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span class=with-love><i class="iconfont icon-love"></i></span><span class=author itemprop=copyrightHolder><a href=https://blog.xil.se/>xil.se</a> |</span>
<span>Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow">Hugo</a> & <a href=https://github.com/liuzc/leaveit target=_blank rel="external nofollow">LeaveIt</a></span></div></footer><script src=https://blog.xil.se/js/vendor_no_gallery.min.js async></script></div></body></html>